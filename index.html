<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•  ì¼ ê´€ë¦¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #1a202c;
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        body.dark {
            background: #1a202c;
            color: #e2e8f0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* í—¤ë” */
        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
        }

        body.dark .header h1 {
            color: #e2e8f0;
        }

        .header p {
            color: #718096;
            font-size: 1.1rem;
        }

        /* ìƒë‹¨ ë²„íŠ¼ë“¤ */
        .top-controls {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 30px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: #3182ce;
            color: white;
        }

        .btn-primary:hover {
            background: #2c5282;
        }

        .btn-secondary {
            background: white;
            color: #4a5568;
            border: 1px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #f7fafc;
        }

        body.dark .btn-secondary {
            background: #2d3748;
            color: #e2e8f0;
            border-color: #4a5568;
        }

        body.dark .btn-secondary:hover {
            background: #4a5568;
        }

        /* í†µê³„ */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 16px;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        body.dark .stats {
            background: #2d3748;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #718096;
        }

        /* ìƒˆ í•  ì¼ ì¶”ê°€ */
        .add-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        body.dark .add-section {
            background: #2d3748;
        }

        .add-trigger {
            width: 100%;
            padding: 16px;
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            background: transparent;
            color: #718096;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .add-trigger:hover {
            border-color: #3182ce;
            color: #3182ce;
        }

        .add-form {
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .input {
            width: 100%;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            transition: border-color 0.2s ease;
        }

        .input:focus {
            outline: none;
            border-color: #3182ce;
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }

        body.dark .input {
            background: #4a5568;
            border-color: #718096;
            color: #e2e8f0;
        }

        body.dark .input:focus {
            border-color: #63b3ed;
        }

        textarea.input {
            resize: vertical;
            min-height: 80px;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        /* í•„í„° ë° ê²€ìƒ‰ */
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 24px;
            align-items: center;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
        }

        .select {
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background: white;
            font-size: 14px;
        }

        body.dark .select {
            background: #4a5568;
            border-color: #718096;
            color: #e2e8f0;
        }

        /* í•  ì¼ ëª©ë¡ */
        .tasks {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .task {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
        }

        .task:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        body.dark .task {
            background: #2d3748;
        }

        .task.completed {
            opacity: 0.6;
        }

        .task-header {
            display: flex;
            align-items: flex-start;
            gap: 16px;
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #cbd5e0;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            margin-top: 2px;
            transition: all 0.2s ease;
        }

        .task-checkbox:hover {
            border-color: #3182ce;
        }

        .task-checkbox.completed {
            background: #48bb78;
            border-color: #48bb78;
            color: white;
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 6px;
            color: #2d3748;
        }

        body.dark .task-title {
            color: #e2e8f0;
        }

        .task.completed .task-title {
            text-decoration: line-through;
            color: #a0aec0;
        }

        .task-note {
            color: #718096;
            font-size: 0.95rem;
            margin-bottom: 12px;
        }

        .task-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: center;
            font-size: 0.9rem;
        }

        .priority {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .priority-high {
            background: #fed7d7;
            color: #c53030;
        }

        .priority-medium {
            background: #fef5e7;
            color: #d69e2e;
        }

        .priority-low {
            background: #c6f6d5;
            color: #2f855a;
        }

        .due-date {
            color: #718096;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .overdue {
            background: #fed7d7;
            color: #c53030;
        }

        .due-soon {
            background: #fef5e7;
            color: #d69e2e;
        }

        .task-actions {
            margin-left: auto;
        }

        .delete-btn {
            padding: 6px;
            background: transparent;
            border: none;
            color: #e53e3e;
            cursor: pointer;
            border-radius: 4px;
            font-size: 16px;
        }

        .delete-btn:hover {
            background: #fed7d7;
        }

        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #a0aec0;
        }

        .empty-state .emoji {
            font-size: 4rem;
            margin-bottom: 16px;
        }

        .empty-state p {
            font-size: 1.1rem;
        }

        /* ìˆ¨ê¹€ í´ë˜ìŠ¤ */
        .hidden {
            display: none !important;
        }

        /* ìœ í‹¸ë¦¬í‹° */
        .blue { color: #3182ce; }
        .green { color: #48bb78; }
        .yellow { color: #d69e2e; }
        .red { color: #e53e3e; }
        .purple { color: #805ad5; }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <h1>í•  ì¼ ê´€ë¦¬</h1>
            <p>ì˜¤ëŠ˜ í•´ì•¼ í•  ì¼ë“¤ì„ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•´ë³´ì„¸ìš”</p>
        </div>

        <!-- ìƒë‹¨ ì»¨íŠ¸ë¡¤ -->
        <div class="top-controls">
            <button id="statsBtn" class="btn btn-secondary">
                ğŸ“Š í†µê³„
            </button>
            <button id="themeBtn" class="btn btn-secondary">
                ğŸŒ™ ë‹¤í¬ëª¨ë“œ
            </button>
        </div>

        <!-- í†µê³„ -->
        <div id="statsPanel" class="stats hidden">
            <div class="stat-item">
                <div id="totalCount" class="stat-number blue">0</div>
                <div class="stat-label">ì „ì²´</div>
            </div>
            <div class="stat-item">
                <div id="completedCount" class="stat-number green">0</div>
                <div class="stat-label">ì™„ë£Œ</div>
            </div>
            <div class="stat-item">
                <div id="pendingCount" class="stat-number yellow">0</div>
                <div class="stat-label">ì§„í–‰ì¤‘</div>
            </div>
            <div class="stat-item">
                <div id="overdueCount" class="stat-number red">0</div>
                <div class="stat-label">ì§€ì—°</div>
            </div>
            <div class="stat-item">
                <div id="highPriorityCount" class="stat-number purple">0</div>
                <div class="stat-label">ì¤‘ìš”</div>
            </div>
        </div>

        <!-- ìƒˆ í•  ì¼ ì¶”ê°€ -->
        <div class="add-section">
            <button id="addTrigger" class="add-trigger">
                â• ìƒˆë¡œìš´ í•  ì¼ ì¶”ê°€í•˜ê¸°
            </button>
            
            <div id="addForm" class="add-form hidden">
                <div class="form-group">
                    <input id="taskTitle" type="text" class="input" placeholder="í•  ì¼ì„ ì…ë ¥í•˜ì„¸ìš”..." />
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <textarea id="taskNote" class="input" placeholder="ìƒì„¸ ì„¤ëª… (ì„ íƒì‚¬í•­)"></textarea>
                    </div>
                    <div>
                        <div class="form-group">
                            <select id="taskPriority" class="input">
                                <option value="medium">â­ ë³´í†µ ìš°ì„ ìˆœìœ„</option>
                                <option value="high">ğŸ”¥ ë†’ì€ ìš°ì„ ìˆœìœ„</option>
                                <option value="low">ğŸ’¤ ë‚®ì€ ìš°ì„ ìˆœìœ„</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input id="taskDueDate" type="datetime-local" class="input" />
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button id="addBtn" class="btn btn-primary">
                        âœ… ì¶”ê°€í•˜ê¸°
                    </button>
                    <button id="cancelBtn" class="btn btn-secondary">
                        ì·¨ì†Œ
                    </button>
                </div>
            </div>
        </div>

        <!-- í•„í„° ë° ê²€ìƒ‰ -->
        <div class="controls">
            <input id="searchInput" type="text" class="input search-input" placeholder="ğŸ” í•  ì¼ ê²€ìƒ‰..." />
            
            <select id="filterSelect" class="select">
                <option value="all">ì „ì²´ ë³´ê¸°</option>
                <option value="pending">ë¯¸ì™„ë£Œë§Œ</option>
                <option value="completed">ì™„ë£Œë§Œ</option>
            </select>
            
            <select id="sortSelect" class="select">
                <option value="created">ìµœì‹ ìˆœ</option>
                <option value="priority">ìš°ì„ ìˆœìœ„ìˆœ</option>
                <option value="dueDate">ë§ˆê°ì¼ìˆœ</option>
            </select>
        </div>

        <!-- í•  ì¼ ëª©ë¡ -->
        <div id="tasksList" class="tasks">
            <div id="emptyState" class="empty-state">
                <div class="emoji">ğŸ“</div>
                <p>ì•„ì§ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.<br>ìƒˆë¡œìš´ í•  ì¼ì„ ì¶”ê°€í•´ë³´ì„¸ìš”!</p>
            </div>
        </div>
    </div>

    <script>
        // ì•± ìƒíƒœ
        let tasks = [];
        let filter = 'all';
        let sortBy = 'created';
        let searchTerm = '';
        let darkMode = false;
        let showStats = false;

        // DOM ìš”ì†Œ
        const elements = {
            statsBtn: document.getElementById('statsBtn'),
            themeBtn: document.getElementById('themeBtn'),
            statsPanel: document.getElementById('statsPanel'),
            addTrigger: document.getElementById('addTrigger'),
            addForm: document.getElementById('addForm'),
            taskTitle: document.getElementById('taskTitle'),
            taskNote: document.getElementById('taskNote'),
            taskPriority: document.getElementById('taskPriority'),
            taskDueDate: document.getElementById('taskDueDate'),
            addBtn: document.getElementById('addBtn'),
            cancelBtn: document.getElementById('cancelBtn'),
            searchInput: document.getElementById('searchInput'),
            filterSelect: document.getElementById('filterSelect'),
            sortSelect: document.getElementById('sortSelect'),
            tasksList: document.getElementById('tasksList'),
            emptyState: document.getElementById('emptyState'),
            totalCount: document.getElementById('totalCount'),
            completedCount: document.getElementById('completedCount'),
            pendingCount: document.getElementById('pendingCount'),
            overdueCount: document.getElementById('overdueCount'),
            highPriorityCount: document.getElementById('highPriorityCount')
        };

        // ì´ˆê¸°í™”
        function init() {
            loadData();
            bindEvents();
            render();
        }

        // ë°ì´í„° ë¡œë“œ
        function loadData() {
            const savedTasks = localStorage.getItem('todoTasks');
            const savedTheme = localStorage.getItem('todoTheme');
            const savedFilter = localStorage.getItem('todoFilter');
            
            if (savedTasks) tasks = JSON.parse(savedTasks);
            if (savedTheme) darkMode = savedTheme === 'dark';
            if (savedFilter) {
                filter = savedFilter;
                elements.filterSelect.value = filter;
            }
        }

        // ë°ì´í„° ì €ì¥
        function saveData() {
            localStorage.setItem('todoTasks', JSON.stringify(tasks));
            localStorage.setItem('todoTheme', darkMode ? 'dark' : 'light');
            localStorage.setItem('todoFilter', filter);
        }

        // ì´ë²¤íŠ¸ ë°”ì¸ë”©
        function bindEvents() {
            // í†µê³„ í† ê¸€
            elements.statsBtn.addEventListener('click', () => {
                showStats = !showStats;
                elements.statsPanel.classList.toggle('hidden', !showStats);
                elements.statsBtn.textContent = showStats ? 'ğŸ“Š í†µê³„ ìˆ¨ê¸°ê¸°' : 'ğŸ“Š í†µê³„';
            });

            // í…Œë§ˆ í† ê¸€
            elements.themeBtn.addEventListener('click', () => {
                darkMode = !darkMode;
                document.body.classList.toggle('dark', darkMode);
                elements.themeBtn.textContent = darkMode ? 'â˜€ï¸ ë¼ì´íŠ¸ëª¨ë“œ' : 'ğŸŒ™ ë‹¤í¬ëª¨ë“œ';
                saveData();
            });

            // í•  ì¼ ì¶”ê°€ í¼ í† ê¸€
            elements.addTrigger.addEventListener('click', showAddForm);
            elements.cancelBtn.addEventListener('click', hideAddForm);
            elements.addBtn.addEventListener('click', addTask);
            elements.taskTitle.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addTask();
            });

            // ê²€ìƒ‰ ë° í•„í„°
            elements.searchInput.addEventListener('input', (e) => {
                searchTerm = e.target.value;
                render();
            });

            elements.filterSelect.addEventListener('change', (e) => {
                filter = e.target.value;
                saveData();
                render();
            });

            elements.sortSelect.addEventListener('change', (e) => {
                sortBy = e.target.value;
                render();
            });
        }

        // í•  ì¼ ì¶”ê°€ í¼ í‘œì‹œ
        function showAddForm() {
            elements.addTrigger.classList.add('hidden');
            elements.addForm.classList.remove('hidden');
            elements.taskTitle.focus();
        }

        // í•  ì¼ ì¶”ê°€ í¼ ìˆ¨ê¸°ê¸°
        function hideAddForm() {
            elements.addTrigger.classList.remove('hidden');
            elements.addForm.classList.add('hidden');
            elements.taskTitle.value = '';
            elements.taskNote.value = '';
            elements.taskPriority.value = 'medium';
            elements.taskDueDate.value = '';
        }

        // í•  ì¼ ì¶”ê°€
        function addTask() {
            const title = elements.taskTitle.value.trim();
            if (!title) return;

            const task = {
                id: Date.now().toString(),
                title: title,
                note: elements.taskNote.value.trim(),
                completed: false,
                priority: elements.taskPriority.value,
                dueDate: elements.taskDueDate.value || null,
                createdAt: new Date().toISOString()
            };

            tasks.unshift(task);
            saveData();
            hideAddForm();
            render();
        }

        // í•  ì¼ ì™„ë£Œ í† ê¸€
        function toggleTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.completed = !task.completed;
                saveData();
                render();
            }
        }

        // í•  ì¼ ì‚­ì œ
        function deleteTask(id) {
            if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                tasks = tasks.filter(t => t.id !== id);
                saveData();
                render();
            }
        }

        // ë§ˆê°ì¼ ìƒíƒœ í™•ì¸
        function getDueDateStatus(dueDate) {
            if (!dueDate) return null;
            
            const now = new Date();
            const due = new Date(dueDate);
            const diffHours = (due - now) / (1000 * 60 * 60);
            
            if (diffHours < 0) return 'overdue';
            if (diffHours < 24) return 'due-soon';
            return 'normal';
        }

        // í•  ì¼ í•„í„°ë§ ë° ì •ë ¬
        function getFilteredTasks() {
            let filtered = tasks.filter(task => {
                if (filter === 'completed' && !task.completed) return false;
                if (filter === 'pending' && task.completed) return false;
                if (searchTerm && !task.title.toLowerCase().includes(searchTerm.toLowerCase())) return false;
                return true;
            });

            return filtered.sort((a, b) => {
                switch (sortBy) {
                    case 'priority':
                        const priorityOrder = { high: 3, medium: 2, low: 1 };
                        return priorityOrder[b.priority] - priorityOrder[a.priority];
                    case 'dueDate':
                        if (!a.dueDate && !b.dueDate) return 0;
                        if (!a.dueDate) return 1;
                        if (!b.dueDate) return -1;
                        return new Date(a.dueDate) - new Date(b.dueDate);
                    default:
                        return new Date(b.createdAt) - new Date(a.createdAt);
                }
            });
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const pending = total - completed;
            const overdue = tasks.filter(t => getDueDateStatus(t.dueDate) === 'overdue').length;
            const highPriority = tasks.filter(t => t.priority === 'high' && !t.completed).length;

            elements.totalCount.textContent = total;
            elements.completedCount.textContent = completed;
            elements.pendingCount.textContent = pending;
            elements.overdueCount.textContent = overdue;
            elements.highPriorityCount.textContent = highPriority;
        }

        // í•  ì¼ HTML ìƒì„±
        function createTaskHTML(task) {
            const dueDateStatus = getDueDateStatus(task.dueDate);
            const priorityIcons = {
                high: 'ğŸ”¥ ë†’ìŒ',
                medium: 'â­ ë³´í†µ',
                low: 'ğŸ’¤ ë‚®ìŒ'
            };

            return `
                <div class="task ${task.completed ? 'completed' : ''}">
                    <div class="task-header">
                        <div class="task-checkbox ${task.completed ? 'completed' : ''}" onclick="toggleTask('${task.id}')">
                            ${task.completed ? 'âœ“' : ''}
                        </div>
                        <div class="task-content">
                            <div class="task-title">${task.title}</div>
                            ${task.note ? `<div class="task-note">${task.note}</div>` : ''}
                            <div class="task-meta">
                                <div class="priority priority-${task.priority}">
                                    ${priorityIcons[task.priority]}
                                </div>
                                ${task.dueDate ? `
                                    <div class="due-date">
                                        ğŸ“… ${new Date(task.dueDate).toLocaleString('ko-KR')}
                                    </div>
                                ` : ''}
                                ${dueDateStatus === 'overdue' ? '<div class="status-badge overdue">ì§€ì—°ë¨</div>' : ''}
                                ${dueDateStatus === 'due-soon' ? '<div class="status-badge due-soon">ì„ë°•</div>' : ''}
                            </div>
                        </div>
                        <div class="task-actions">
                            <button class="delete-btn" onclick="deleteTask('${task.id}')">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // ë Œë”ë§
        function render() {
            const filteredTasks = getFilteredTasks();
            updateStats();

            if (filteredTasks.length === 0) {
                elements.emptyState.style.display = 'block';
                elements.tasksList.innerHTML = '';
                elements.tasksList.appendChild(elements.emptyState);
            } else {
                elements.emptyState.style.display = 'none';
                elements.tasksList.innerHTML = filteredTasks.map(createTaskHTML).join('');
            }

            // í…Œë§ˆ ì ìš©
            document.body.classList.toggle('dark', darkMode);
            elements.themeBtn.textContent = darkMode ? 'â˜€ï¸ ë¼ì´íŠ¸ëª¨ë“œ' : 'ğŸŒ™ ë‹¤í¬ëª¨ë“œ';
        }

        // ì „ì—­ í•¨ìˆ˜
        window.toggleTask = toggleTask;
        window.deleteTask = deleteTask;

        // ì•± ì‹œì‘
        init();
    </script>
</body>
</html>
